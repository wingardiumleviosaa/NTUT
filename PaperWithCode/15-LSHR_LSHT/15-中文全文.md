

摘要：手部動作識別非常重要，因為通信、人機交互和手勢控制都依賴於此。基於骨架的動作識別傳統上包括手部動作，然而至今仍然是難以正確識別的類別之一。我們提出了一種專門為手部動作識別設計的方法，該方法使用相對角度嵌入和局部球諧函數來創建新的手部表示。球諧函數的使用創造了旋轉不變的表示，使得手部動作識別在應對不同個體之間的差異和視角變化時更加穩健。我們在 First-Person Hand Action Benchmark（包括 RGB-D 視頻和 3D 手部姿勢註釋）和 NTU RGB+D 120 數據集上的手部關節進行了廣泛的實驗，證明了使用局部球諧函數表示的優勢。我們的代碼可在 [https://github.com/KathPra/LSHR_LSHT](https://github.com/KathPra/LSHR_LSHT) 獲得。

**關鍵詞**：手部動作識別 · 球諧函數 · 旋轉不變性 · 相對角度嵌入。

## **1. 引言**

手部動作隨處可見。它們可以在對話中觀察到，並提供有關氛圍、層級、背景和情緒的重要信息。此外，手部動作的細微差異使得動作識別成為一個充滿挑戰的任務。基於骨架的動作識別自然包含了手部動作，但要區分它們仍然非常困難。尤其在人機交互中，準確識別手部動作至關重要，例如理解空中引號或豎起大拇指的手勢。如果手部動作識別進一步優化，將有廣泛的應用可以從中受益，例如醫療領域中的手部運動理解、手勢控制以及機器人技術。此外，隨著線上互動的增多，出現了許多僅能獲取部分身體關節數據的情境。在所有身體關節中，手部關節最有可能出現在數位記錄中，並且表現力豐富。因此，我們專注於手部動作，並提出一種能更好地區分它們的方法。由於手部非常靈活，它們的嵌入表示可以大大受益於局部、相對的描述。

自 1990 年代後期以來，動作識別一直是活躍的研究領域。最早進入該領域的進展之一是使用循環神經網絡（RNNs），其中包括長短期記憶網絡（LSTMs）來捕捉時間上的動作變化。隨後，卷積神經網絡（CNNs）將動作以 2D 地圖的形式呈現，包括語義信息作為特徵，如關節類型、時間戳和位置。近年來，圖卷積網絡（GCNs）經常被採用並表現出強大的性能。與 CNNs 不同，GCNs 可以利用骨架數據的內在結構。關節被表示為圖中的節點，邊表示它們的物理連接或相關性。動作識別使用各種形式的輸入數據，從 RGB+深度視頻數據到從視頻中提取的骨架關節的笛卡爾坐標。使用骨架數據可以提高模型效率，並增強對視點和外觀變化的魯棒性。總的來說，動作識別非常受益於對手部運動的理解，這促使我們特別關注手部關節。我們將每個手部關節相對於其他關節進行描述。這種方式使得關節之間的關係被顯式包含在數據中，而不需要模型推斷。

![[PaperWithCode/15-LSHR_LSHT/Figure1.png]]
圖 1. 手應受到特別重視，因為它們具有最高的關節密度，並且它們的相互作用是識別手部動作的關鍵。手關節（左）首先被描述為局部球座標（中），然後再用局部球諧函數（右）表示。然後將手關節表示作為附加輸入輸入模型中。

我們提出使用角度嵌入和局部球諧函數來表示細微的動作變化，這在圖 1 中可視化。我們假設局部球面表示比笛卡爾坐標更合適，原因有三：（1）手部關節的絕對位置非常接近，當以相對位置來描述它們時，小的變化變得更加明顯；（2）手指之間的相互作用是動作識別中最重要的線索之一；（3）手部非常靈活，將關節的相對位置轉換為球面投影可以促進對細微運動變化的魯棒性。在以往的研究中，圓柱坐標已經被證明可以提高檢測精度。我們提出一種基於局部球諧函數表示的角度嵌入，因為我們發現它適合描述手部關節的相對位置，即建模關節之間的關係。此外，數據轉換使得該表示在處理個體差異和視角變化時更加穩健，因為它具有部分的旋轉不變性。我們還提出了手部關節的局部球諧變換，一種完全旋轉不變的表示。據我們所知，我們是首個在手部動作識別領域中使用球諧函數的人。本研究的主要貢獻總結如下：

1. 我們通過其局部鄰域來描述每個手部關節，以促進更好的手部動作識別。  
2. 我們將角度嵌入與標準輸入結合，作為一種顯式的運動描述，更好地表現手部關節之間的關係。  
3. 我們將球諧變換與標準輸入結合，作為旋轉不變的運動描述，增加手部動作識別在視角或方向變化中的魯棒性。  
4. 我們表明，角度表示（明確表示關節之間的關係）可以顯著提高 FPHA [11] 數據集中對自我中心視角手部動作的識別。  
5. 我們進一步證明，角度球面嵌入同樣可以被經典的基於人體骨架的動作識別模型（如 CTRGCN [3]）利用，從而提高基於手部的動作識別準確性。
## **2. 相關工作**
### **2.1 基於骨架的動作識別**  
基於骨架的動作識別最初採用了循環神經網絡（RNN）來學習時間上的特徵，如長短期記憶網絡（LSTM）因其能夠在時間上調節學習而廣受歡迎。此外，時序狀態空間模型（TF）、Gram 矩陣和時序循環模型（HBRNN）也是流行的選擇。在使用學習特徵之前，手工設計的特徵已經取得了與現代方法相當的準確性。最後，關鍵姿態模型如 Moving Pose 使用改良的 kNN 聚類來檢測動作，而 Hu 等人則提出了一個異質特徵學習框架。針對基於骨架的動作識別，圖卷積網絡（GCN）已經被提出，例如 [25,30,34,44,45]，並且與卷積神經網絡（CNNs）不同，它們直接定義在圖上。GCNs 可以分為兩大類，即頻譜方法和空間方法。雖然研究主要推動了 GCNs 的發展，但 CNNs 和 Transformer 仍然是動作識別的科學討論的一部分。

隨著時間的推移，已經提出了不同的方法，但從先前的研究中可以總結出一個主要趨勢：結合額外信息有助於提高模型的準確性。Qin 等人將多個身體關節之間的角度納入了他們的模型。最近，多模態集成已被證明可以提高整體準確性。雖然基於骨架的動作識別主要集中在全身，例如流行的 NTU RGB-D 120 基準數據集，但一些研究人員已經看到專注於手部動作的價值。Garcia 等人發布了 First-Person Hand Action Benchmark（FPHA），該數據集包含日常手部動作的自我中心視角錄像，涵蓋三大類別：社交、廚房和辦公動作。這兩個數據集都包含在本研究中。我們的目標是推進基於骨架的手部動作識別。因此，我們將基於骨架的動作識別文獻的回顧限制在最相關的工作上。

### **2.2 頻域表示的動作識別**  
將骨架信息表示在頻域而非空間域中有兩大優勢。首先，可以更輕鬆地去除噪音；其次，可以引入旋轉不變性。當將數據從空間域轉換到頻域時，數據被表示為一組頻率的總和。如果輸入數據格式是笛卡爾坐標，通常使用傅立葉變換；如果輸入是球面坐標，則可以使用球諧函數。除了輸入格式的不同，這些方法在本質上是等價的。它們通過將函數從空間域映射到頻域，將其近似為正弦波的總和。許多動作識別的先前工作已經使用了傅立葉變換。

從人體記錄中去除噪音總是有益的，例如當揮手時，如果排除高頻運動（如手部顫抖），就更容易正確識別動作。由於頻域數據是複數的，它需要進行轉換才能輸入標準的神經網絡。使用旋轉不變的幅度表示使得數據歸一化變得不再必要，並且在具有不同視角的應用中可以提高識別準確性。

### **2.3 球諧函數在 3D 點雲中的應用**  
據我們所知，我們是首個在基於骨架的動作識別中使用球諧函數的人。然而，在 3D 點雲中，球諧函數已被用來使數據表示對旋轉具有魯棒性或等變性。Esteves 等人將 3D 點雲映射為球面函數，並提出了對隨機旋轉具有魯棒性的球面卷積。類似地，Spezialetti 等人提出了一個自監督學習框架，使用球面 CNN 來學習物體的標準表面方向，以便在不依賴 SO(3) 旋轉的情況下檢測它們。Poulard 等人提出了直接在點雲中運行的球面卷積核。Li 等人比較了幾種前述的方法，並在數據點在訓練過程中繞一個或三個軸旋轉的設置中進行了測試。他們強調了 SPH-Net 的強大性能，其準確性在訓練過程中繞任意軸旋轉時仍保持在相同水平。Fang 等人指出常規 CNN 比球面 CNN 更具優勢。因此，我們將球諧函數作為嵌入，並應用標準 CNN 或 GCN 進行學習。

## **3 方法**  
我們提出了多模態手部關節表示，通過這些表示，模型可以學習特徵表示。基於骨架的動作識別通常使用五維笛卡爾坐標 $X \in \mathbb{R}^{N×M×C×T×V}$，其中 N 表示批次大小，M 表示行為記錄中的人數，C 表示通道維度，T 表示幀數，V 表示關節數。我們將笛卡爾坐標與使用球諧基函數創建的局部嵌入進行結合。

### **3.1 局部球面坐標**  
我們首先通過將每個手部關節作為坐標系的中心來納入手部關節的局部鄰域，同時描繪其他關節相對於中心關節的位置，如圖 2 所示。我們結合所有手部關節的局部表示，以捕捉細微的動作變化，例如「比 OK 手勢」和「比勝利手勢」之間的差異，儘管這兩個動作中拇指和食指的絕對位置非常相似。

這將 $X \in \mathbb{R}^{N×M×C×T×V}$ 轉換為 $X_{\text{loc}} \in \mathbb{R}^{N×M×C×T×V×V}$，最後一個維度包含相對於中心關節位置的關節局部鄰域。我們計算了所有手部關節的局部鄰域，預期通過研究其局部鄰域將獲得最大的優勢。

此外，我們將局部坐標從笛卡爾坐標轉換為球面坐標，因為角度比位置更適合描述手部運動。球面坐標由三個值（$r$、$\theta$、$\phi$）組成，用來描述 3D 空間中的點位置，如圖 3（a）所示。它們可以使用笛卡爾坐標作為輸入來計算。半徑 $r \in [0, ∞)$ 定義為從原點到坐標點的向量長度，即 $r = \sqrt{x^2 + y^2 + z^2}$。極角 $\theta = \arctan \left( \frac{\sqrt{x^2 + y^2}}{z} \right)$ 描述了點的緯度，並定義在 $\theta \in [0, π]$。方位角 $\phi = \arctan \left( \frac{y}{x} \right)$ 描述了點的經度，並定義在 $\phi \in [0, 2π]$。方位角描述了相對於正 x 軸在 xy 平面中的位置。

![[PaperWithCode/15-LSHR_LSHT/Figure2.png]]
圖 2. 笛卡爾全域座標（左）和局部球面座標（右）之間的轉換，其中所有座標都是相對於彼此關節計算的。全域座標是直角座標，而局部座標是球面座標。

![[PaperWithCode/15-LSHR_LSHT/Figure3.png]]
圖 3. (a) 笛卡爾座標 (x, y, z) 與球座標 (r, θ, φ) 之間的轉換。球座標由半徑r、極角θ和方位角φ組成； (b) 球諧函數實部的可視化，其中紅色表示正值，藍色表示負值。距原點的距離可視化各個角度方向上球諧函數的大小。

### **3.2 基於球諧函數的手部關節表示**

我們提出了角度嵌入和球諧函數作為手部動作識別的新型表示，這是通過局部球面坐標實現的。所有基於球諧函數的表示自然提供了從粗到細的表示，並且可以根據球面上的頻率帶進行解釋。這包括使用球諧基函數和完整的球諧變換的表示。此外，球諧變換的幅度具有旋轉不變性，這是一個對手部動作識別非常有用的特性。

圖 3 可視化了我們如何首先將手部坐標從笛卡爾坐標轉換為球面坐標（a），然後根據它們的球諧基函數進行表示（b）。球面上的一個函數可以用球諧函數表示為：

$$f(\theta,\phi)=\sum_{\ell=0}^\infty\sum_{m=-\ell}^{m=\ell}a_m^\ell Y_m^\ell(\theta,\phi) \tag{1}$$

其中，球諧基函數 $Y_{l}^{m}(θ, φ)$ 定義為：

$$Y_{\ell,m}(\theta,\phi)=\sqrt{\frac{(\ell-m)!(2\ell+1)}{(\ell+m)!4\pi}}e^{im\phi}P_{\ell}^{m}cos\theta  \tag{2}$$

在這裡，$Y_{l}^{m}(θ, φ)$ 是球諧基函數，符號「!」表示階乘運算。球諧函數以兩個球面坐標為輸入，即方位角 $θ$ 和極角 $φ$，並包含了相關的勒讓德多項式 $P_{l}^{m}$，其中參數 $l$ 是度數，$m$ 是順序，範圍為 $m ∈ [-l, l]$，兩者均為實數。局部球諧基函數表示 [LSHR] 的幅度對於繞 y 軸的旋轉是不變的，因為複指數函數的幅度為 1。局部球諧變換 [LSHT] 的幅度具有 $SO(3)$ 旋轉不變性。我們認為，這樣的表示在學習識別來自不同視角的手部動作時是有利的。我們進一步預期，這些表示將在跨主體的手部方向差異中支持動作識別。

我們採用了 $l ∈ \{1, 2\}$ 的球諧函數來進行基於骨架的手部動作識別，如圖 3（b）所示。包含 $l = 0$ 並不包含與動作相關的特定信息，我們假設所有相關信息都包含在前兩個頻帶中，即 $l ≤ 2$。參數 $l$ 定義為節線或頻帶的數量，因此隨著 $l$ 的增大，代表的頻率越高；去除高頻率可以減少數據中的噪聲。

選擇的球諧表示被沿通道維度堆疊，並與原始輸入串聯。由於球諧函數是複數形式，即 $x = a + bi$，它們不能直接輸入標準的神經網絡。它們需要表示為其實部和虛部，或者表示為其幅度和相位。如果只使用其中一部分，表示將不再完整，輸入將無法完全恢復。實部和虛部是複數的完整表示。當只使用實部或虛部時，數學上來說，表示不再完整。幅度則具有旋轉不變性。

### **3.3 模型**

我們將角度嵌入、局部球諧函數表示（LSHR）和球諧變換（LSHT）應用於簡單的基線模型（GCN-BL）和一個先進的模型（CTR-GCN），兩者均由 Chen 等人提出。Chen 等人提出的通道級拓撲精煉圖卷積模型（CTR-GCN）具有簡潔的模型架構和較少的訓練週期，並且達到了最新的研究水平。兩個模型的描述參照了 Chen 等人的描述。這兩個模型都由 10 層組成，每層包含一個空間圖卷積網絡（GCN）模塊和一個時間卷積網絡（TCN）模塊。CTR-GCN 模型在推斷過程中學習一個非共享的通道拓撲結構並動態推斷關節關係，而 GCN-BL 模型則學習所有通道之間共享的靜態拓撲。進一步的實現細節可以在補充材料的第 D 部分找到。

### **3.4 評估**

角度嵌入和球諧函數的評估是基於它們在所有身體關節的準確性提升 [Imp.] 以及專注於手部關節的準確性提升 [Hand Imp.]。在訓練期間，我們隨機旋轉輸入數據。在模型的第一層之前，將局部球諧函數表示與標準的模型輸入（笛卡爾坐標）連接，這只會微小地增加參數數量，因為僅改變了輸入維度，而非層輸出的維度。在評估手部關節的角度嵌入或球諧函數效果時，模型會與原始實現進行比較。為了保持數據結構 $X \in \mathbb{R}^{N×M×C×T×V}$，對於所有非手部關節，會插入零值。我們的消融研究包含一個僅在角度嵌入上訓練的模型，並在 FPHA 上進行評估。此外，NTU120 的消融研究包含一個維度相同的基線模型，在該模型中隨機數替代了角度嵌入。

## **4. 實驗**

### **4.1 數據集**

手部關節的局部球諧函數表示（LSHR）和局部球諧變換（LSHT）的優勢在兩個數據集上展示：主要是 First-Person Hand Action Benchmark。該數據集由 Garcia-Hernando 等人創建，包含六名受試者在肩膀上安裝的相機錄製的四十五個動作類別的視頻，每個類別進行四到六次。該數據集包含 1175 個時間序列的骨架錄像，涵蓋了每根手指的四個關節和手腕，如圖 4 所示。該數據集以 1:1 的比例劃分為訓練集和測試集。錄像之間的視角有所不同，這使得該任務同時是跨主體和跨設置的挑戰。

![[PaperWithCode/15-LSHR_LSHT/Figure4.png]]
圖 4. 第一人稱手部動作基準 [11] 中手部關節的可視化（自己的可視化）。

其次，我們使用了 NTU RGB+D 120 基準數據集。該數據集包含 120 個動作類別，可以分為日常、醫療和犯罪行為。數據集包含 114,480 段視頻，涉及 106 名不同的受試者和 32 種場景（攝像機高度與受試者距離）。該數據集可以在兩種設定下進行評估，即跨主體和跨設置。在跨主體評估中，106 名受試者被分為訓練集和測試集。在跨設置設定中，某些拍攝角度和背景僅用於訓練，而其他則用於測試。這兩種情況下的訓練集和測試集的劃分均為 1:1。局部球諧函數的計算僅針對八個手部關節，即左右手腕、手部、大拇指和手指。

### **4.2 實現細節**

實驗在 NVIDIA Tesla V100 GPU 上使用 PyTorch 框架進行。Chen 等人提出的 GCN-BL 和 CTRGCN 模型具有相同的超參數設置，即使用帶 0.9 動量的 SGD 優化器，權重衰減為 0.0004，訓練 65 個週期，包括 5 個熱身週期。初始學習率設置為 0.1，並在第 35 和 55 個週期後衰減 0.1 倍。批次大小為 64，所有動作錄像被調整為 64 幀。對於 FPHA 數據集，由於數據集較小，批次大小設為 25。實驗在 AMD Ryzen 9 5900x 上進行。

### **4.3 實驗結果**

在 First-Person Hand Action Benchmark（FPHA）上的實驗展示了角度嵌入和局部球諧函數表示（LSHR）的優勢，如表 1 所示。模型準確性在 GCN-BL 和 CTR-GCN 模型上均有所提高。我們通過選擇角度嵌入作為唯一的模型輸入對我們的方法進行了消融實驗；結果表明，它們的表現遠超原始模型。原始的 CTR-GCN 模型由於嚴重的過擬合，導致其測試準確性低於 GCN-BL 模型。相較之下，原始的 GCN-BL 模型過擬合較少，因此準確性較高。

![[PaperWithCode/15-LSHR_LSHT/Table1.png]]
表 1. 使用實部和虛部 (R& I) 或旋轉不變性 (M)，與原始模型相比，僅 LSHR (*)。我們的方法顯著提高了準確性。

如表 1 所示，CTR-GCN 模型使用角度嵌入的旋轉不變幅度和局部球諧函數表示（LSHR）後，模型性能增幅最大（+18%）。局部球諧變換（LSHT）也遠超原始模型（+15%）。結果表明，直接從基函數學習局部相對手部表示比單純使用球諧函數更有利。GCN-BL 模型的性能與 CTR-GCN 模型不同，這可能是由於模型設計的差異。GCN-BL 具有共享拓撲，而 CTR-GCN 模型使用的是通道級拓撲。進一步的角度嵌入格式報告在補充材料 A 部分中。

當我們將方法與在 First-Person Hand Action Benchmark 上評估的其他方法進行比較時，顯然我們的模型比先前報告的模型有了大幅提升，如表 2 所示。我們的準確性比先前報告的使用 Gram 矩陣的最佳模型高出 7%。

![[PaperWithCode/15-LSHR_LSHT/Table2.png]]
表 2. 第一人稱手部動作基準的模型評估 [11]。我們使用角度嵌入大小的模型優於所有其他模型。

在像 FPHA 這樣僅針對手部的數據集上評估時，我們的方法顯著優於其他模型。此外，當在全身骨架數據集上進行評估時，我們的方法仍然比原始模型的表現更好。我們在 NTU120 數據集上評估了角度嵌入和局部球諧函數表示（LSHR）。在 Cross-Subject 和 Cross-Setup 基準中，我們評估了多種輸入格式。這些基準提供了有關旋轉不變特徵性能的進一步見解。在 Cross-Subject 基準中，我們可以評估角度嵌入和球諧函數對跨主體差異的魯棒性。Cross-Setup 基準允許我們顯式評估方法的旋轉不變性。使用 GCN-BL 模型的結果證實了從 FPHA 數據集中得出的結論，即角度嵌入和局部球諧函數表示（LSHR）提高了整體模型準確性（見表 3）。當僅評估與手部相關的動作類別時，這種提升更加明顯[Hand Imp.]。有關手部與非手部相關動作類別的完整列表可在補充材料 C 部分中找到。在 Cross-Subject 設定下，角度嵌入的實部和虛部組合帶來了最大的準確性提升，這符合我們的預期。對於跨主體動作識別，使用旋轉不變的表示並不那麼有利。在 Cross-Setup 設定下，角度嵌入的幅度帶來了最大的準確性提升，這符合我們的預期，即旋轉不變表示非常適合該設定。相位信息降低了模型的準確性，因為它包含了旋轉信息，這在比較不同視角時會阻礙識別。當我們調查 NTU120 數據集上局部角度嵌入、局部球諧函數表示（LSHR）和球諧變換（LSHT）之間的差異時，可以看出 GCN-BL 模型從局部角度球諧函數表示（LSHR）的包含中受益。然而，CTR-GCN 模型在使用局部球諧變換（LSHT）時達到了更高的準確性。

![[PaperWithCode/15-LSHR_LSHT/Table3.png]]
表 3. 在 NTU120 上使用帶有角度嵌入的 GCN-BL 的聯合模態的格式比較。與隨機基線 (Rand. BL) 相比，我們的方法提高了整體準確性 (Imp.) 和手部相關動作準確性 (Hand Imp.)。

![[PaperWithCode/15-LSHR_LSHT/Table4.png]]
表 4. 在兩個 NTU120 基準上使用局部球面諧波表示 [LSHR] 和旋轉不變局部球面諧波轉換 [LSHT] 進行單模態評估 [23]。旋轉不變的手部關節表示提高了模型的準確性。

如表 5 所示，通過加入角度嵌入、局部球諧函數表示（LSHR）或球諧變換（LSHT），集成性能得到提升。使用完整的局部球諧變換（LSHT）的模型以微小的優勢超過了其他模型。由於我們的方法僅包含關節，因此骨骼模態總是來自原始模型，且不包含任何角度嵌入或球諧變換。


![[PaperWithCode/15-LSHR_LSHT/Table5.png]]
表 5. 原始版本的 CTR-GCN 模型與兩種局部球面諧波表示 [LSHR]、全譜（實部和虛部）和旋轉不變性（幅度）以及完整球面諧波變換 [LSHT] 的整合評估]。 LSHT 略優於所有其他模型。

我們在 NTU120 基準上進行了進一步的實驗，比較了旋轉不變和完整的角度嵌入、局部球諧函數表示（LSHR），並在補充材料 B 部分報告了手部準確性和總體準確性。由於我們的方法專注於手部關節，與原始模型相比，手部準確性的增幅大於總體準確性增幅。


## **5. 討論與結論**

基於局部球諧函數的旋轉不變關節表示改進了基於骨架的手部動作識別。它們的加入使我們能夠更好地區分細微的手部動作。無論是理論框架還是實驗結果都證實了手部關節的局部球諧函數表示提升了骨架動作識別的準確性。我們顯著超越了其他方法，尤其是在僅涉及手部的 First-Person-Hand-Action-Benchmark [11] 上。對 NTU120 Cross-Subject 和 Cross-Setup 基準的評估進一步確認了我們的發現。我們的實驗表明，旋轉不變的手部表示提高了對跨主體方向差異和視角變化的魯棒性，從而導致更高的準確性水平。在 NTU120 數據集上，整體最佳模型性能如預期在 Cross-Setup 設定下使用關節位置模態中實現，這得益於特徵的旋轉不變性。Cross-Subject 設定從旋轉不變性中獲得的益處超出了預期，這暗示著可以通過角度嵌入來減少跨主體的差異。例如動作「比出和平手勢」，不同受試者的手部方向略有不同。

我們希望為未來在其他數據模態上適應角度嵌入的研究開闢道路。此外，NTU120 中每只手包含的手部關節數為四個，這意味著進一步探索增加數據點的抽樣將是一個有意義的研究方向。